---
title: Simpsons String
author: Zach Bogart
date: '2021-10-14'
slug: simpsons-string
categories:
  - R
tags:
  - tidyverse
subtitle: "Quickly now!"
summary: "Ordering data like in the simpsons"
image:
  caption: ''
  focal_point: ''
  preview_only: yes
output: html_document
editor_options:
  chunk_output_type: console
links:
  donate_button:
    icon: seedling
    icon_pack: fas
    name: Ways to Support
    url: /support/
---

<!-- Icon Image: Small -->

<img src="featured.png" width="100"/>

<!--Starting Blurb-->

> Time for a head count. Children line up according to height.
> 
> Uh, no wait! No, the sum total of the letters in your last name if each letter is assigned a numeric value according to its place in the alphabet, quickly now!
>
> - Principal Skinner

<!--Put actual work here-->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      cache.lazy = FALSE,
                      fig.width = 8,
                      fig.height = 5,
                      message = FALSE)
```

```{r include=FALSE}
library(tidyverse)
library(rvest)
```

```{r include=FALSE}
html <- read_html("https://simpsons.fandom.com/wiki/List_of_Springfield_Elementary_School_Students")
raw_vector <- html %>% 
  html_elements(".wikitable td") %>% 
  html_text2()

springfield_elementary <- as_tibble(matrix(raw_vector, ncol = 3, byrow = TRUE), .name_repair = "universal") %>% 
  select(...1) %>% 
  rename(name = ...1)

```

Here are the students:

```{r}
springfield_elementary
```

Let's do the calculations. 
- Split up a string into two parts by spaces ("Milhouse Van Houten" â†’ "Milhouse" "Van Houten"), take the last item
- Split up the last name, make sure it is lowercase, [deal with accents](https://github.com/tidyverse/stringr/issues/149), use base `letters` to get the number of the alphabet, and reduce the whole thing together.

```{r}
# split up name, get last name
get_last_name = function(name) {
  splt = str_split(name, pattern = " ", n=2)
  result = tail(splt[[1]], n = 1)
  return(result)
}

# split up last name, parse, and sum result 
letter_to_number_place <- function(input) {
  unpacked_name <- str_split(input, pattern = "")
  lowercase <- map(unpacked_name[[1]], tolower)
  letter_places <- map(lowercase, ~match(stringi::stri_trans_general(., "Latin-ASCII"), letters, nomatch = 0)) # Uter!
  total <- reduce(letter_places, sum)
  return(total)
}

```

```{r}
# quickly now!
ordering <- springfield_elementary %>% 
  filter(str_detect(name, " ")) %>% 
  select(name) %>% 
  mutate(last_name = map_chr(name, get_last_name)) %>% 
  mutate(total = map_dbl(last_name, letter_to_number_place))

ordering %>% 
  arrange(total)
```

Till next time!

![](https://media.giphy.com/media/ASd0Ukj0y3qMM/giphy.gif)

<!--Noun Image Credit-->

#### Image Credit

[building](https://thenounproject.com/search/?creator=4129988&name=Zach+Bogart&q=school&i=3644756) by Zach Bogart from [the Noun Project](https://thenounproject.com/)
